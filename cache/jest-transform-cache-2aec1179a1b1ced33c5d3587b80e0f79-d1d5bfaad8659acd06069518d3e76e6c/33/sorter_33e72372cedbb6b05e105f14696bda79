190ef5b90bf27fb8f0d7661d300c64ce
var addSorting = function () {
  'use strict';

  var cols,
      currentSort = {
    index: 0,
    desc: false
  };

  function getTable() {
    return document.querySelector('.coverage-summary');
  }

  function getTableHeader() {
    return getTable().querySelector('thead tr');
  }

  function getTableBody() {
    return getTable().querySelector('tbody');
  }

  function getNthColumn(n) {
    return getTableHeader().querySelectorAll('th')[n];
  }

  function onFilterInput() {
    var searchValue = document.getElementById('fileSearch').value;
    var rows = document.getElementsByTagName('tbody')[0].children;

    for (var i = 0; i < rows.length; i++) {
      var row = rows[i];

      if (row.textContent.toLowerCase().includes(searchValue.toLowerCase())) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    }
  }

  function addSearchBox() {
    var template = document.getElementById('filterTemplate');
    var templateClone = template.content.cloneNode(true);
    templateClone.getElementById('fileSearch').oninput = onFilterInput;
    template.parentElement.appendChild(templateClone);
  }

  function loadColumns() {
    var colNodes = getTableHeader().querySelectorAll('th'),
        colNode,
        cols = [],
        col,
        i;

    for (i = 0; i < colNodes.length; i += 1) {
      colNode = colNodes[i];
      col = {
        key: colNode.getAttribute('data-col'),
        sortable: !colNode.getAttribute('data-nosort'),
        type: colNode.getAttribute('data-type') || 'string'
      };
      cols.push(col);

      if (col.sortable) {
        col.defaultDescSort = col.type === 'number';
        colNode.innerHTML = colNode.innerHTML + '<span class="sorter"></span>';
      }
    }

    return cols;
  }

  function loadRowData(tableRow) {
    var tableCols = tableRow.querySelectorAll('td'),
        colNode,
        col,
        data = {},
        i,
        val;

    for (i = 0; i < tableCols.length; i += 1) {
      colNode = tableCols[i];
      col = cols[i];
      val = colNode.getAttribute('data-value');

      if (col.type === 'number') {
        val = Number(val);
      }

      data[col.key] = val;
    }

    return data;
  }

  function loadData() {
    var rows = getTableBody().querySelectorAll('tr'),
        i;

    for (i = 0; i < rows.length; i += 1) {
      rows[i].data = loadRowData(rows[i]);
    }
  }

  function sortByIndex(index, desc) {
    var key = cols[index].key,
        sorter = function sorter(a, b) {
      a = a.data[key];
      b = b.data[key];
      return a < b ? -1 : a > b ? 1 : 0;
    },
        finalSorter = sorter,
        tableBody = document.querySelector('.coverage-summary tbody'),
        rowNodes = tableBody.querySelectorAll('tr'),
        rows = [],
        i;

    if (desc) {
      finalSorter = function finalSorter(a, b) {
        return -1 * sorter(a, b);
      };
    }

    for (i = 0; i < rowNodes.length; i += 1) {
      rows.push(rowNodes[i]);
      tableBody.removeChild(rowNodes[i]);
    }

    rows.sort(finalSorter);

    for (i = 0; i < rows.length; i += 1) {
      tableBody.appendChild(rows[i]);
    }
  }

  function removeSortIndicators() {
    var col = getNthColumn(currentSort.index),
        cls = col.className;
    cls = cls.replace(/ sorted$/, '').replace(/ sorted-desc$/, '');
    col.className = cls;
  }

  function addSortIndicators() {
    getNthColumn(currentSort.index).className += currentSort.desc ? ' sorted-desc' : ' sorted';
  }

  function enableUI() {
    var i,
        el,
        ithSorter = function ithSorter(i) {
      var col = cols[i];
      return function () {
        var desc = col.defaultDescSort;

        if (currentSort.index === i) {
          desc = !currentSort.desc;
        }

        sortByIndex(i, desc);
        removeSortIndicators();
        currentSort.index = i;
        currentSort.desc = desc;
        addSortIndicators();
      };
    };

    for (i = 0; i < cols.length; i += 1) {
      if (cols[i].sortable) {
        el = getNthColumn(i).querySelector('.sorter').parentElement;

        if (el.addEventListener) {
          el.addEventListener('click', ithSorter(i));
        } else {
          el.attachEvent('onclick', ithSorter(i));
        }
      }
    }
  }

  return function () {
    if (!getTable()) {
      return;
    }

    cols = loadColumns();
    loadData();
    addSearchBox();
    addSortIndicators();
    enableUI();
  };
}();

window.addEventListener('load', addSorting);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvcnRlci5qcyJdLCJuYW1lcyI6WyJhZGRTb3J0aW5nIiwiY29scyIsImN1cnJlbnRTb3J0IiwiaW5kZXgiLCJkZXNjIiwiZ2V0VGFibGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRUYWJsZUhlYWRlciIsImdldFRhYmxlQm9keSIsImdldE50aENvbHVtbiIsIm4iLCJxdWVyeVNlbGVjdG9yQWxsIiwib25GaWx0ZXJJbnB1dCIsInNlYXJjaFZhbHVlIiwiZ2V0RWxlbWVudEJ5SWQiLCJ2YWx1ZSIsInJvd3MiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImNoaWxkcmVuIiwiaSIsImxlbmd0aCIsInJvdyIsInRleHRDb250ZW50IiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsInN0eWxlIiwiZGlzcGxheSIsImFkZFNlYXJjaEJveCIsInRlbXBsYXRlIiwidGVtcGxhdGVDbG9uZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJvbmlucHV0IiwicGFyZW50RWxlbWVudCIsImFwcGVuZENoaWxkIiwibG9hZENvbHVtbnMiLCJjb2xOb2RlcyIsImNvbE5vZGUiLCJjb2wiLCJrZXkiLCJnZXRBdHRyaWJ1dGUiLCJzb3J0YWJsZSIsInR5cGUiLCJwdXNoIiwiZGVmYXVsdERlc2NTb3J0IiwiaW5uZXJIVE1MIiwibG9hZFJvd0RhdGEiLCJ0YWJsZVJvdyIsInRhYmxlQ29scyIsImRhdGEiLCJ2YWwiLCJOdW1iZXIiLCJsb2FkRGF0YSIsInNvcnRCeUluZGV4Iiwic29ydGVyIiwiYSIsImIiLCJmaW5hbFNvcnRlciIsInRhYmxlQm9keSIsInJvd05vZGVzIiwicmVtb3ZlQ2hpbGQiLCJzb3J0IiwicmVtb3ZlU29ydEluZGljYXRvcnMiLCJjbHMiLCJjbGFzc05hbWUiLCJyZXBsYWNlIiwiYWRkU29ydEluZGljYXRvcnMiLCJlbmFibGVVSSIsImVsIiwiaXRoU29ydGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImF0dGFjaEV2ZW50Iiwid2luZG93Il0sIm1h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RUQsU0FBTyxZQUFXO0FBQ2QsUUFBSSxDQUFDZixRQUFRLEVBQWIsRUFBaUI7QUFDYjtBQUNIOztBQUNESixJQUFBQSxJQUFJLEdBQUdtQyxXQUFXLEVBQWxCO0FBQ0FpQixJQUFBQSxRQUFRO0FBQ1J6QixJQUFBQSxZQUFZO0FBQ1p1QyxJQUFBQSxpQkFBaUI7QUFDakJDLElBQUFBLFFBQVE7QUFDWCxHQVREO0FBVUgsQ0FoTWdCLEVBQWpCOztBQWtNQUssTUFBTSxDQUFDRixnQkFBUCxDQUF3QixNQUF4QixFQUFnQ3ZFLFVBQWhDIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgKi9cbnZhciBhZGRTb3J0aW5nID0gKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICB2YXIgY29scyxcbiAgICAgICAgY3VycmVudFNvcnQgPSB7XG4gICAgICAgICAgICBpbmRleDogMCxcbiAgICAgICAgICAgIGRlc2M6IGZhbHNlXG4gICAgICAgIH07XG5cbiAgICAvLyByZXR1cm5zIHRoZSBzdW1tYXJ5IHRhYmxlIGVsZW1lbnRcbiAgICBmdW5jdGlvbiBnZXRUYWJsZSgpIHtcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb3ZlcmFnZS1zdW1tYXJ5Jyk7XG4gICAgfVxuICAgIC8vIHJldHVybnMgdGhlIHRoZWFkIGVsZW1lbnQgb2YgdGhlIHN1bW1hcnkgdGFibGVcbiAgICBmdW5jdGlvbiBnZXRUYWJsZUhlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIGdldFRhYmxlKCkucXVlcnlTZWxlY3RvcigndGhlYWQgdHInKTtcbiAgICB9XG4gICAgLy8gcmV0dXJucyB0aGUgdGJvZHkgZWxlbWVudCBvZiB0aGUgc3VtbWFyeSB0YWJsZVxuICAgIGZ1bmN0aW9uIGdldFRhYmxlQm9keSgpIHtcbiAgICAgICAgcmV0dXJuIGdldFRhYmxlKCkucXVlcnlTZWxlY3RvcigndGJvZHknKTtcbiAgICB9XG4gICAgLy8gcmV0dXJucyB0aGUgdGggZWxlbWVudCBmb3IgbnRoIGNvbHVtblxuICAgIGZ1bmN0aW9uIGdldE50aENvbHVtbihuKSB7XG4gICAgICAgIHJldHVybiBnZXRUYWJsZUhlYWRlcigpLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RoJylbbl07XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25GaWx0ZXJJbnB1dCgpIHtcbiAgICAgICAgY29uc3Qgc2VhcmNoVmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZVNlYXJjaCcpLnZhbHVlO1xuICAgICAgICBjb25zdCByb3dzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3Rib2R5JylbMF0uY2hpbGRyZW47XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgcm93ID0gcm93c1tpXTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICByb3cudGV4dENvbnRlbnRcbiAgICAgICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAgICAgLmluY2x1ZGVzKHNlYXJjaFZhbHVlLnRvTG93ZXJDYXNlKCkpXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9ICcnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByb3cuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGxvYWRzIHRoZSBzZWFyY2ggYm94XG4gICAgZnVuY3Rpb24gYWRkU2VhcmNoQm94KCkge1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsdGVyVGVtcGxhdGUnKTtcbiAgICAgICAgdmFyIHRlbXBsYXRlQ2xvbmUgPSB0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgdGVtcGxhdGVDbG9uZS5nZXRFbGVtZW50QnlJZCgnZmlsZVNlYXJjaCcpLm9uaW5wdXQgPSBvbkZpbHRlcklucHV0O1xuICAgICAgICB0ZW1wbGF0ZS5wYXJlbnRFbGVtZW50LmFwcGVuZENoaWxkKHRlbXBsYXRlQ2xvbmUpO1xuICAgIH1cblxuICAgIC8vIGxvYWRzIGFsbCBjb2x1bW5zXG4gICAgZnVuY3Rpb24gbG9hZENvbHVtbnMoKSB7XG4gICAgICAgIHZhciBjb2xOb2RlcyA9IGdldFRhYmxlSGVhZGVyKCkucXVlcnlTZWxlY3RvckFsbCgndGgnKSxcbiAgICAgICAgICAgIGNvbE5vZGUsXG4gICAgICAgICAgICBjb2xzID0gW10sXG4gICAgICAgICAgICBjb2wsXG4gICAgICAgICAgICBpO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2xOb2Rlcy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgY29sTm9kZSA9IGNvbE5vZGVzW2ldO1xuICAgICAgICAgICAgY29sID0ge1xuICAgICAgICAgICAgICAgIGtleTogY29sTm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtY29sJyksXG4gICAgICAgICAgICAgICAgc29ydGFibGU6ICFjb2xOb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1ub3NvcnQnKSxcbiAgICAgICAgICAgICAgICB0eXBlOiBjb2xOb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlJykgfHwgJ3N0cmluZydcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb2xzLnB1c2goY29sKTtcbiAgICAgICAgICAgIGlmIChjb2wuc29ydGFibGUpIHtcbiAgICAgICAgICAgICAgICBjb2wuZGVmYXVsdERlc2NTb3J0ID0gY29sLnR5cGUgPT09ICdudW1iZXInO1xuICAgICAgICAgICAgICAgIGNvbE5vZGUuaW5uZXJIVE1MID1cbiAgICAgICAgICAgICAgICAgICAgY29sTm9kZS5pbm5lckhUTUwgKyAnPHNwYW4gY2xhc3M9XCJzb3J0ZXJcIj48L3NwYW4+JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29scztcbiAgICB9XG4gICAgLy8gYXR0YWNoZXMgYSBkYXRhIGF0dHJpYnV0ZSB0byBldmVyeSB0ciBlbGVtZW50IHdpdGggYW4gb2JqZWN0XG4gICAgLy8gb2YgZGF0YSB2YWx1ZXMga2V5ZWQgYnkgY29sdW1uIG5hbWVcbiAgICBmdW5jdGlvbiBsb2FkUm93RGF0YSh0YWJsZVJvdykge1xuICAgICAgICB2YXIgdGFibGVDb2xzID0gdGFibGVSb3cucXVlcnlTZWxlY3RvckFsbCgndGQnKSxcbiAgICAgICAgICAgIGNvbE5vZGUsXG4gICAgICAgICAgICBjb2wsXG4gICAgICAgICAgICBkYXRhID0ge30sXG4gICAgICAgICAgICBpLFxuICAgICAgICAgICAgdmFsO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGFibGVDb2xzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBjb2xOb2RlID0gdGFibGVDb2xzW2ldO1xuICAgICAgICAgICAgY29sID0gY29sc1tpXTtcbiAgICAgICAgICAgIHZhbCA9IGNvbE5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXZhbHVlJyk7XG4gICAgICAgICAgICBpZiAoY29sLnR5cGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgdmFsID0gTnVtYmVyKHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhW2NvbC5rZXldID0gdmFsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICAvLyBsb2FkcyBhbGwgcm93IGRhdGFcbiAgICBmdW5jdGlvbiBsb2FkRGF0YSgpIHtcbiAgICAgICAgdmFyIHJvd3MgPSBnZXRUYWJsZUJvZHkoKS5xdWVyeVNlbGVjdG9yQWxsKCd0cicpLFxuICAgICAgICAgICAgaTtcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgcm93c1tpXS5kYXRhID0gbG9hZFJvd0RhdGEocm93c1tpXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLy8gc29ydHMgdGhlIHRhYmxlIHVzaW5nIHRoZSBkYXRhIGZvciB0aGUgaXRoIGNvbHVtblxuICAgIGZ1bmN0aW9uIHNvcnRCeUluZGV4KGluZGV4LCBkZXNjKSB7XG4gICAgICAgIHZhciBrZXkgPSBjb2xzW2luZGV4XS5rZXksXG4gICAgICAgICAgICBzb3J0ZXIgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgICAgICAgICAgYSA9IGEuZGF0YVtrZXldO1xuICAgICAgICAgICAgICAgIGIgPSBiLmRhdGFba2V5XTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYSA8IGIgPyAtMSA6IGEgPiBiID8gMSA6IDA7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZmluYWxTb3J0ZXIgPSBzb3J0ZXIsXG4gICAgICAgICAgICB0YWJsZUJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY292ZXJhZ2Utc3VtbWFyeSB0Ym9keScpLFxuICAgICAgICAgICAgcm93Tm9kZXMgPSB0YWJsZUJvZHkucXVlcnlTZWxlY3RvckFsbCgndHInKSxcbiAgICAgICAgICAgIHJvd3MgPSBbXSxcbiAgICAgICAgICAgIGk7XG5cbiAgICAgICAgaWYgKGRlc2MpIHtcbiAgICAgICAgICAgIGZpbmFsU29ydGVyID0gZnVuY3Rpb24oYSwgYikge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMSAqIHNvcnRlcihhLCBiKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93Tm9kZXMubGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgICAgIHJvd3MucHVzaChyb3dOb2Rlc1tpXSk7XG4gICAgICAgICAgICB0YWJsZUJvZHkucmVtb3ZlQ2hpbGQocm93Tm9kZXNbaV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgcm93cy5zb3J0KGZpbmFsU29ydGVyKTtcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgcm93cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICAgICAgdGFibGVCb2R5LmFwcGVuZENoaWxkKHJvd3NbaV0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8vIHJlbW92ZXMgc29ydCBpbmRpY2F0b3JzIGZvciBjdXJyZW50IGNvbHVtbiBiZWluZyBzb3J0ZWRcbiAgICBmdW5jdGlvbiByZW1vdmVTb3J0SW5kaWNhdG9ycygpIHtcbiAgICAgICAgdmFyIGNvbCA9IGdldE50aENvbHVtbihjdXJyZW50U29ydC5pbmRleCksXG4gICAgICAgICAgICBjbHMgPSBjb2wuY2xhc3NOYW1lO1xuXG4gICAgICAgIGNscyA9IGNscy5yZXBsYWNlKC8gc29ydGVkJC8sICcnKS5yZXBsYWNlKC8gc29ydGVkLWRlc2MkLywgJycpO1xuICAgICAgICBjb2wuY2xhc3NOYW1lID0gY2xzO1xuICAgIH1cbiAgICAvLyBhZGRzIHNvcnQgaW5kaWNhdG9ycyBmb3IgY3VycmVudCBjb2x1bW4gYmVpbmcgc29ydGVkXG4gICAgZnVuY3Rpb24gYWRkU29ydEluZGljYXRvcnMoKSB7XG4gICAgICAgIGdldE50aENvbHVtbihjdXJyZW50U29ydC5pbmRleCkuY2xhc3NOYW1lICs9IGN1cnJlbnRTb3J0LmRlc2NcbiAgICAgICAgICAgID8gJyBzb3J0ZWQtZGVzYydcbiAgICAgICAgICAgIDogJyBzb3J0ZWQnO1xuICAgIH1cbiAgICAvLyBhZGRzIGV2ZW50IGxpc3RlbmVycyBmb3IgYWxsIHNvcnRlciB3aWRnZXRzXG4gICAgZnVuY3Rpb24gZW5hYmxlVUkoKSB7XG4gICAgICAgIHZhciBpLFxuICAgICAgICAgICAgZWwsXG4gICAgICAgICAgICBpdGhTb3J0ZXIgPSBmdW5jdGlvbiBpdGhTb3J0ZXIoaSkge1xuICAgICAgICAgICAgICAgIHZhciBjb2wgPSBjb2xzW2ldO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVzYyA9IGNvbC5kZWZhdWx0RGVzY1NvcnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTb3J0LmluZGV4ID09PSBpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXNjID0gIWN1cnJlbnRTb3J0LmRlc2M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc29ydEJ5SW5kZXgoaSwgZGVzYyk7XG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZVNvcnRJbmRpY2F0b3JzKCk7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTb3J0LmluZGV4ID0gaTtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFNvcnQuZGVzYyA9IGRlc2M7XG4gICAgICAgICAgICAgICAgICAgIGFkZFNvcnRJbmRpY2F0b3JzKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBjb2xzLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgICAgICBpZiAoY29sc1tpXS5zb3J0YWJsZSkge1xuICAgICAgICAgICAgICAgIC8vIGFkZCB0aGUgY2xpY2sgZXZlbnQgaGFuZGxlciBvbiB0aGUgdGggc28gdXNlcnNcbiAgICAgICAgICAgICAgICAvLyBkb250IGhhdmUgdG8gY2xpY2sgb24gdGhvc2UgdGlueSBhcnJvd3NcbiAgICAgICAgICAgICAgICBlbCA9IGdldE50aENvbHVtbihpKS5xdWVyeVNlbGVjdG9yKCcuc29ydGVyJykucGFyZW50RWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGl0aFNvcnRlcihpKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWwuYXR0YWNoRXZlbnQoJ29uY2xpY2snLCBpdGhTb3J0ZXIoaSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBhZGRzIHNvcnRpbmcgZnVuY3Rpb25hbGl0eSB0byB0aGUgVUlcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghZ2V0VGFibGUoKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbHMgPSBsb2FkQ29sdW1ucygpO1xuICAgICAgICBsb2FkRGF0YSgpO1xuICAgICAgICBhZGRTZWFyY2hCb3goKTtcbiAgICAgICAgYWRkU29ydEluZGljYXRvcnMoKTtcbiAgICAgICAgZW5hYmxlVUkoKTtcbiAgICB9O1xufSkoKTtcblxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCBhZGRTb3J0aW5nKTtcbiJdfQ==